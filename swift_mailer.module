<?php

//Include required files.
module_load_include('inc', 'swift_mailer', '/includes/classes/SWIFTMailSystem');
module_load_include('inc', 'swift_mailer', '/includes/helpers/conversion');

//Define permissions
DEFINE('SWIFT_MAILER_ADMINISTER', 'swift_mailer_administer');

//Define system variables.
DEFINE('SWIFT_MAILER_VARIABLE_FORMAT', 'swift_mailer_format');
DEFINE('SWIFT_MAILER_VARIABLE_TRANSPORT', 'swift_mailer_transport');

//Define message formats.
DEFINE('SWIFT_MAILER_FORMAT_PLAIN', 'text/plain');
DEFINE('SWIFT_MAILER_FORMAT_HTML', 'text/html');

//Define transport types
DEFINE('SWIFT_MAILER_TRANSPORT_SMTP', 'smtp');
DEFINE('SWIFT_MAILER_TRANSPORT_SENDMAIL', 'sendmail');
DEFINE('SWIFT_MAILER_TRANSPORT_NATIVE', 'native');

DEFINE('SWIFT_MAILER_HEADER_TEXT', 'text');
DEFINE('SWIFT_MAILER_HEADER_PARAMETERIZED', 'parameterized');
DEFINE('SWIFT_MAILER_HEADER_MAILBOX', 'mailbox');
DEFINE('SWIFT_MAILER_HEADER_DATE', 'date');
DEFINE('SWIFT_MAILER_HEADER_ID', 'ID');
DEFINE('SWIFT_MAILER_HEADER_PATH', 'path');

/**
 *
 * Implementation of hook_menu().
 *
 */
function swift_mailer_menu() {
    
  $items['swift_mailer/test'] = array(
    'type'              => MENU_CALLBACK,
    'title'             => 'Swift Mailer Test Page',
    'page callback'     => 'swift_mailer_page_swift_mailer_test',
    'file'              => 'includes/pages/swift_mailer_page_swift_mailer_test.inc',
    'access arguments'  => array('access content'),
  );

  $items['admin/config/swift_mailer'] = array(
    'type'              => MENU_NORMAL_ITEM,
    'title'             => 'Swift Mailer',
    'description'       => 'Configure how Swift Mailer will send e-mails.',
    'page callback'     => 'swift_mailer_page_admin_config_swift_mailer',
    'file'              => 'includes/pages/swift_mailer_page_admin_config_swift_mailer.inc',
    'access arguments'  => array(SWIFT_MAILER_ADMINISTER),
  );

  return $items;
    
}

/**
 * Implementation of hook_mail().
 */
function swift_mailer_mail($key, &$message, $params) {

    switch($key) {
        default:
            $text[] = '<strong>Dear User,</strong>';
            $text[] = '<p>';
            $text[] = 'This is a test e-mail automatically generated by the Swift Mailer module.';
            $text[] = '</p>';
            $text[] = 'Kind regards<br />';
            $text[] = '<br />';
            $text[] = 'The Swift Mailer module<br />';

            $message['subject'] = t('Swift Mailer Test');
            $message['body'][] = t(implode($text));
            break;
    }
}
?>
